import{d as A,r as s,a as G,o as g,c as h,i as e,n as V,u as y,h as S,p as z,k as O,_ as R,j as b,l as X,v as U,t as $,e as T,m as H,w as q,q as J,s as N,b as K,f as D}from"./index-EejqKmlh.js";import{j as Q,a as W,_ as Y,b as Z,c as ee}from"./judge-xJS3uye-.js";import{e as j,s as F}from"./message-pw9Rr1l4.js";import{u as se,p as ae}from"./request-lDjR4_Aw.js";const te=n=>(z("data-v-ae06c598"),n=n(),O(),n),le=te(()=>e("div",{class:"typeface"},"向右拖动滑块",-1)),oe={key:0,class:"iconfont icon-youjian"},ce={key:1,class:"iconfont icon-cuowu1",style:{color:"#fff"}},ie={key:2,class:"iconfont icon-0-58",style:{color:"#fff"}},ne=A({__name:"captcha",setup(n,{expose:x}){const p=s(),c=s(),l=s();let r=s(0),u=0,f=s(0),k=s(0),t=s(0),d=s(0),i=s(!1),a=s("padding"),I=s(!1);document.onselectstart=()=>!1,G(()=>{r.value=Math.ceil(p.value.getBoundingClientRect().left)});const M=_=>{i.value===!1&&a.value==="padding"&&(i.value=!0,u=_.clientX,d.value=u-r.value,f.value=u,k.value=f.value+190)},C=_=>{i.value&&(t.value=_.clientX-r.value-d.value,t.value<0?t.value=0:t.value>190&&(t.value=190))},L=()=>{i.value&&(t.value<190?(j("验证失败，请重新验证"),a.value="error",c.value.classList.add("slider-error"),l.value.classList.add("filled-error"),setTimeout(()=>{t.value=0,a.value="padding",c.value.classList.remove("slider-error"),l.value.classList.remove("filled-error")},3e3)):(F("验证成功"),t.value=190,a.value="success",c.value.classList.add("slider-success"),l.value.classList.add("filled-success"),I.value=a.value==="success"),i.value=!1)},P=()=>{i.value&&(document.addEventListener("mousemove",C),document.addEventListener("mouseup",L))};return x({isSuccess:I}),(_,B)=>(g(),h("div",{class:"track",ref_key:"trackLeftX",ref:p,onMouseout:P},[le,e("div",{class:"filled-noactive",ref_key:"filled",ref:l,style:V({width:y(t)+"px"})},null,4),e("div",{class:"slider-noactive",ref_key:"slider",ref:c,style:V({left:y(t)+"px"}),onMousedown:M},[y(a)==="padding"?(g(),h("i",oe)):S("",!0),y(a)==="error"?(g(),h("i",ce)):S("",!0),y(a)==="success"?(g(),h("i",ie)):S("",!0)],36)],544))}}),ue=R(ne,[["__scopeId","data-v-ae06c598"]]),v=n=>(z("data-v-6a909cf9"),n=n(),O(),n),re={class:"main-box"},de=v(()=>e("img",{src:Y,class:"circle"},null,-1)),ve={class:"panel"},fe=v(()=>e("img",{src:Z,style:{transform:"scale(0.7)","-webkit-user-drag":"none"}},null,-1)),pe={class:"contents"},_e=v(()=>e("div",{class:"cloudmind"},[e("img",{src:ee})],-1)),me=v(()=>e("button",null,"登 录",-1)),ge={class:"input"},he={class:"email"},ke=v(()=>e("i",{class:"iconfont icon-user-solid",style:{color:"rgb(187, 186, 186)"}},null,-1)),we={class:"password"},ye=v(()=>e("i",{class:"iconfont icon-lock-solid",style:{color:"rgb(187, 186, 186)"}},null,-1)),be={key:0,class:"captcha"},xe=v(()=>e("div",{class:"auto-forget"},[e("div",null,[e("input",{type:"checkbox",id:"checkbox",class:"checkbox-input"}),e("label",{class:"checkbox-lable",for:"checkbox"},"自动登录")]),e("div",{class:"forget"},"忘记密码?")],-1)),Ie={class:"agreements"},Le=v(()=>e("label",{for:"agreement",class:"agreement-lable"},"已阅读并同意以下协议 ",-1)),Se=J('<div class="third" data-v-6a909cf9><div class="third-login" data-v-6a909cf9><div data-v-6a909cf9></div><div data-v-6a909cf9>第三方登录</div><div data-v-6a909cf9></div></div><div data-v-6a909cf9><i class="iconfont icon-qq qq" data-v-6a909cf9></i><i class="iconfont icon-weixin weixin" data-v-6a909cf9></i><i class="iconfont icon-gitub gitub" data-v-6a909cf9></i><i class="iconfont icon-gitee1 gitee" data-v-6a909cf9></i></div></div>',1),je=A({__name:"login",setup(n){const x=se(),p=s(),c=s(""),l=s(""),r=s(""),u=s(""),f=s(!1),k=s(!1),t=s(!1),d=s(!1),i=s(!1),a=s(!1),I=()=>{f.value=Q(c.value),f.value?k.value=!0:k.value=!1},M=()=>{c.value===""?(d.value=!0,r.value="邮箱不能为空"):f.value?d.value=!1:(d.value=!0,r.value="邮箱格式不正确")},C=()=>{l.value.length===0?(a.value=!0,u.value="密码不能为空"):l.value.length<8?(a.value=!0,u.value="密码长度不能小于8位"):l.value.length===20?(a.value=!0,u.value="密码长度不能大于20位"):L()},L=()=>{W(l.value)?(a.value=!1,t.value=!0):(a.value=!0,u.value="密码需要同时包含字母和数字")},P=()=>!!(f.value&&t.value),_=()=>{if(c.value===""){d.value=!0,r.value="邮箱不能为空";return}P()&&i.value&&p.value.isSuccess?ae("/auth/emailLogin",{email:c.value,password:l.value}).then(o=>{x.setUserInfo(o.userId,o.shortToken,o.longToken,o.chatToken,!1),x.localSetUserInfo(o.userId,o.shortToken,o.longToken,o.chatToken,!1),F("登录成功"),N.push("/")}).catch(o=>{console.log(o)}):p.value.isSuccess?i.value?j("请正确填写邮箱和密码"):j("请阅读并同意用户协议和隐私政策"):j("未进行人机验证")},B=()=>N.push("/register");return(o,m)=>{const E=K("router-link");return g(),h("div",re,[de,e("div",ve,[fe,e("div",pe,[_e,e("div",{class:"switch"},[me,e("button",{style:{cursor:"pointer"},onClick:B},"注 册")]),e("div",ge,[e("div",he,[ke,b(e("input",{class:"email-input",type:"text",placeholder:"邮箱","onUpdate:modelValue":m[0]||(m[0]=w=>c.value=w),onInput:I,onBlur:M},null,544),[[X,c.value]])]),b(e("div",{class:"email-msg"},"* "+$(r.value),513),[[U,d.value]]),e("div",we,[ye,b(e("input",{class:"password-input",type:"password",placeholder:"密码","onUpdate:modelValue":m[1]||(m[1]=w=>l.value=w),onInput:C,onBlur:L},null,544),[[X,l.value]])]),b(e("div",{class:"password-msg"},"* "+$(u.value),513),[[U,a.value]]),k.value?(g(),h("div",be,[T(ue,{ref_key:"captcha",ref:p},null,512)])):S("",!0),xe,e("button",{class:"login-button",onClick:_},"登录"),e("div",Ie,[b(e("input",{type:"checkbox",id:"agreement",style:{"vertical-align":"middle"},"onUpdate:modelValue":m[2]||(m[2]=w=>i.value=w)},null,512),[[H,i.value]]),Le,T(E,{to:"/agreements_user",style:{color:"rgba(60, 176, 253, 1)","text-decoration":"none","vertical-align":"middle"}},{default:q(()=>[D(" 用户协议、")]),_:1}),T(E,{to:"/agreements_privacy",style:{color:"rgba(60, 176, 253, 1)","text-decoration":"none","vertical-align":"middle"}},{default:q(()=>[D("隐私政策")]),_:1})])]),Se])])])}}}),Be=R(je,[["__scopeId","data-v-6a909cf9"]]);export{Be as default};
